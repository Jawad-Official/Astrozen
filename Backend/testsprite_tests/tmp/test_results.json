[
  {
    "projectId": "eb8cad19-0f4f-47b0-997f-d05e3bc5e388",
    "testId": "d6c6e522-7f36-422e-a471-29aa26b14974",
    "userId": "8478f478-80b1-7092-d595-8f5fa7d36f82",
    "title": "TC001-user registration with valid data",
    "description": "Test the /auth/register endpoint to ensure a new user can register successfully with valid email, password, first_name, and last_name, and that the response returns appropriate success status.",
    "code": "import requests\nimport uuid\nimport time\n\nBASE_URL = \"http://localhost:8000/api/v1\"\nTIMEOUT = 30\n\ndef test_user_registration_with_valid_data():\n    unique_suffix = str(int(time.time() * 1000))\n    email = f\"user_{unique_suffix}@example.com\"\n    password = \"StrongPassw0rd!\"\n    first_name = f\"FirstName{unique_suffix}\"\n    last_name = f\"LastName{unique_suffix}\"\n    \n    url = f\"{BASE_URL}/auth/register\"\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n    payload = {\n        \"email\": email,\n        \"password\": password,\n        \"first_name\": first_name,\n        \"last_name\": last_name\n    }\n    \n    try:\n        response = requests.post(url, json=payload, headers=headers, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request to {url} failed: {e}\"\n    \n    assert response.status_code in (200, 201), f\"Expected 200 or 201, got {response.status_code}, response: {response.text}\"\n    try:\n        json_response = response.json()\n    except ValueError:\n        assert False, \"Response is not valid JSON\"\n    \n    # Verify response contains at least an identifier or success confirmation\n    assert \"email\" in json_response, \"Response JSON missing 'email' key\"\n    assert json_response.get(\"email\") == email, f\"Registered email mismatch, expected {email}\"\n    \n    # Additional keys can be validated if known, but not specified in PRD; just check success implied\n    # The test assumes success response includes registered user email\n    \ntest_user_registration_with_valid_data()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-01-25T21:03:27.794Z",
    "modified": "2026-01-25T21:03:59.268Z"
  },
  {
    "projectId": "eb8cad19-0f4f-47b0-997f-d05e3bc5e388",
    "testId": "ded54a51-0f77-404d-8ae8-b90f3c76b3dd",
    "userId": "8478f478-80b1-7092-d595-8f5fa7d36f82",
    "title": "TC002-user login with correct credentials",
    "description": "Test the /auth/login endpoint to verify that a user can log in with valid username and password, and receives a valid JWT access token.",
    "code": "import requests\nimport uuid\n\nBASE_URL = \"http://localhost:8000/api/v1\"\nTIMEOUT = 30\n\n\ndef test_user_login_with_correct_credentials():\n    # Generate unique user data\n    unique_suffix = str(uuid.uuid4())\n    email = f\"user_{unique_suffix}@example.com\"\n    password = \"StrongPassword123!\"\n    first_name = \"TestFirstName\"\n    last_name = \"TestLastName\"\n\n    # Register new user\n    register_url = f\"{BASE_URL}/auth/register\"\n    register_payload = {\n        \"email\": email,\n        \"password\": password,\n        \"first_name\": first_name,\n        \"last_name\": last_name,\n    }\n    try:\n        register_response = requests.post(register_url, json=register_payload, timeout=TIMEOUT)\n        assert register_response.status_code == 201 or register_response.status_code == 200, \\\n            f\"Registration failed: {register_response.status_code} {register_response.text}\"\n\n        # Login with created user credentials\n        login_url = f\"{BASE_URL}/auth/login\"\n        login_payload = {\n            \"username\": email,\n            \"password\": password\n        }\n        headers = {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n        }\n        login_response = requests.post(login_url, data=login_payload, headers=headers, timeout=TIMEOUT)\n        assert login_response.status_code == 200, f\"Login failed: {login_response.status_code} {login_response.text}\"\n\n        login_json = login_response.json()\n        assert \"access_token\" in login_json, \"Access token is missing in login response\"\n        assert isinstance(login_json[\"access_token\"], str) and len(login_json[\"access_token\"]) > 0, \\\n            \"Access token is empty or invalid\"\n\n        # Optionally check token type if present\n        if \"token_type\" in login_json:\n            assert login_json[\"token_type\"].lower() == \"bearer\", \"Unexpected token_type in login response\"\n\n    finally:\n        # No user deletion endpoint described, so no cleanup possible here\n        pass\n\n\ntest_user_login_with_correct_credentials()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-01-25T21:03:27.800Z",
    "modified": "2026-01-25T21:04:20.027Z"
  },
  {
    "projectId": "eb8cad19-0f4f-47b0-997f-d05e3bc5e388",
    "testId": "6839e364-c29d-4f97-9956-3de2bdd6c565",
    "userId": "8478f478-80b1-7092-d595-8f5fa7d36f82",
    "title": "TC003-create organization and default team creation",
    "description": "Test the /organizations POST endpoint to create a new organization and verify that a default team is automatically created for the user.",
    "code": "import requests\nimport uuid\nimport random\nimport string\n\nBASE_URL = \"http://localhost:8000/api/v1\"\nTIMEOUT = 30\n\n\ndef test_create_organization_and_default_team_creation():\n    # Generate unique user registration details\n    unique_suffix = uuid.uuid4().hex[:8]\n    email = f\"user_{unique_suffix}@example.com\"\n    password = \"StrongPass123!\"\n    first_name = f\"First{unique_suffix}\"\n    last_name = f\"Last{unique_suffix}\"\n\n    headers_json = {\"Content-Type\": \"application/json\"}\n    session = requests.Session()\n\n    # Register User\n    register_payload = {\n        \"email\": email,\n        \"password\": password,\n        \"first_name\": first_name,\n        \"last_name\": last_name,\n    }\n    try:\n        resp = session.post(\n            f\"{BASE_URL}/auth/register\", json=register_payload, headers=headers_json, timeout=TIMEOUT\n        )\n        assert resp.status_code == 201 or resp.status_code == 200, f\"Failed to register user: {resp.text}\"\n\n        # Login User to get token\n        login_payload = {\"username\": email, \"password\": password}\n        headers_form = {\"Content-Type\": \"application/x-www-form-urlencoded\"}\n        resp = session.post(\n            f\"{BASE_URL}/auth/login\", data=login_payload, headers=headers_form, timeout=TIMEOUT\n        )\n        assert resp.status_code == 200, f\"Failed to login user: {resp.text}\"\n        token = resp.json().get(\"access_token\")\n        assert token, \"No access token received on login\"\n\n        auth_headers = {\n            \"Authorization\": f\"Bearer {token}\",\n            \"Content-Type\": \"application/json\",\n        }\n\n        # Create Organization\n        org_name = f\"Org_{unique_suffix}\"\n        org_payload = {\"name\": org_name}\n        resp = session.post(\n            f\"{BASE_URL}/organizations\", json=org_payload, headers=auth_headers, timeout=TIMEOUT\n        )\n        assert resp.status_code == 201 or resp.status_code == 200, f\"Failed to create organization: {resp.text}\"\n        org_data = resp.json()\n        org_id = org_data.get(\"id\")\n        assert org_id, \"Organization ID not returned\"\n\n        # Confirm default team creation by listing teams or querying teams endpoint\n        # Since no /organizations/{id}/teams endpoint is specified, we'll list teams and find one linked to org\n        # We will try GET /teams - assuming it returns all teams user can access\n        resp = session.get(f\"{BASE_URL}/teams\", headers=auth_headers, timeout=TIMEOUT)\n        assert resp.status_code == 200, f\"Failed to get teams: {resp.text}\"\n        teams = resp.json()\n        # Look for a team associated with this org or a default team (assuming team has org_id or org linkage)\n        # Since schema details are sparse, infer team structure: id, name, maybe organization info\n\n        default_team = None\n        for team in teams:\n            # Try to find a team that belongs to the created organization\n            # Heuristic: team name or structure?\n            # Because the default team is created automatically for the user upon org creation,\n            # We assume at least 1 team exists and is related to the organization.\n            # So check if team has organization id or if team name contains org name, fallback to first team.\n            # We'll verify at least one team exists.\n            # If more specific logic is needed, it can be adjusted.\n\n            if \"organization_id\" in team and team[\"organization_id\"] == org_id:\n                default_team = team\n                break\n\n        if not default_team:\n            # If no organization_id, fallback to first team created after org creation.\n            # Retrieve team list again and pick the latest one.\n            if len(teams) > 0:\n                default_team = teams[-1]\n\n        assert default_team is not None, \"Default team was not created automatically with the organization\"\n    finally:\n        # Cleanup created organization and user resources if possible - not defined in PRD\n        # If no delete user endpoint, we only try to delete organization\n        if 'auth_headers' in locals() and 'org_id' in locals():\n            try:\n                session.delete(f\"{BASE_URL}/organizations/{org_id}\", headers=auth_headers, timeout=TIMEOUT)\n            except Exception:\n                pass\n\n\ntest_create_organization_and_default_team_creation()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-01-25T21:03:27.805Z",
    "modified": "2026-01-25T21:04:04.147Z"
  },
  {
    "projectId": "eb8cad19-0f4f-47b0-997f-d05e3bc5e388",
    "testId": "621c08c3-49f7-4779-bbb8-bff0927ac683",
    "userId": "8478f478-80b1-7092-d595-8f5fa7d36f82",
    "title": "TC004-create team with unique identifier",
    "description": "Test the /teams POST endpoint to create a new team with a unique identifier and name, ensuring that duplicate identifiers are rejected.",
    "code": "import requests\nimport uuid\nimport random\nimport string\n\nBASE_URL = \"http://localhost:8000/api/v1\"\nTIMEOUT = 30\n\ndef random_string(length=8):\n    return ''.join(random.choices(string.ascii_lowercase + string.digits, k=length))\n\ndef test_create_team_with_unique_identifier():\n    email = f\"user_{random_string()}@example.com\"\n    password = \"StrongP@ssw0rd\"\n    first_name = \"TestFirst\"\n    last_name = \"TestLast\"\n\n    headers = {\"Content-Type\": \"application/json\"}\n\n    # Register user\n    register_payload = {\n        \"email\": email,\n        \"password\": password,\n        \"first_name\": first_name,\n        \"last_name\": last_name\n    }\n    r = requests.post(f\"{BASE_URL}/auth/register\", json=register_payload, timeout=TIMEOUT)\n    assert r.status_code == 201 or r.status_code == 200, f\"Registration failed: {r.text}\"\n\n    # Login user\n    login_payload = {\n        \"username\": email,\n        \"password\": password\n    }\n    r = requests.post(f\"{BASE_URL}/auth/login\", data=login_payload, timeout=TIMEOUT)\n    assert r.status_code == 200, f\"Login failed: {r.text}\"\n    token = r.json().get(\"access_token\")\n    assert token, \"Access token missing in login response\"\n\n    auth_headers = {\"Authorization\": f\"Bearer {token}\", \"Content-Type\": \"application/json\"}\n\n    # Create organization (which auto creates default team)\n    org_name = f\"Org_{random_string()}\"\n    org_payload = {\"name\": org_name}\n    r = requests.post(f\"{BASE_URL}/organizations\", json=org_payload, headers=auth_headers, timeout=TIMEOUT)\n    assert r.status_code == 201 or r.status_code == 200, f\"Organization creation failed: {r.text}\"\n    organization = r.json()\n    org_id = organization.get(\"id\")\n    assert org_id, \"Organization id missing\"\n\n    created_team_ids = []\n\n    try:\n        # Create first new team with unique identifier\n        team_identifier = f\"team-{uuid.uuid4()}\"\n        team_name = f\"Team {random_string(6)}\"\n        team_payload = {\n            \"name\": team_name,\n            \"identifier\": team_identifier\n        }\n        r = requests.post(f\"{BASE_URL}/teams\", json=team_payload, headers=auth_headers, timeout=TIMEOUT)\n        assert r.status_code == 201 or r.status_code == 200, f\"Team creation failed: {r.text}\"\n        team = r.json()\n        team_id = team.get(\"id\")\n        assert team_id, \"Team id missing after creation\"\n        created_team_ids.append(team_id)\n        assert team.get(\"identifier\") == team_identifier, \"Team identifier mismatch\"\n\n        # Attempt to create a duplicate team with the same identifier\n        duplicate_payload = {\n            \"name\": f\"Duplicate {random_string(6)}\",\n            \"identifier\": team_identifier\n        }\n        r = requests.post(f\"{BASE_URL}/teams\", json=duplicate_payload, headers=auth_headers, timeout=TIMEOUT)\n        # Should fail due to duplicate identifier\n        assert r.status_code == 400 or r.status_code == 409, f\"Duplicate team creation should fail but got: {r.status_code} - {r.text}\"\n\n    finally:\n        # Cleanup created teams\n        for tid in created_team_ids:\n            requests.delete(f\"{BASE_URL}/teams/{tid}\", headers=auth_headers, timeout=TIMEOUT)\n        # Cleanup organization\n        if org_id:\n            requests.delete(f\"{BASE_URL}/organizations/{org_id}\", headers=auth_headers, timeout=TIMEOUT)\n\ntest_create_team_with_unique_identifier()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 86, in <module>\n  File \"<string>\", line 62, in test_create_team_with_unique_identifier\nAssertionError: Team creation failed: Internal Server Error\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-01-25T21:03:27.810Z",
    "modified": "2026-01-25T21:04:25.972Z"
  },
  {
    "projectId": "eb8cad19-0f4f-47b0-997f-d05e3bc5e388",
    "testId": "7364af3d-749a-40e1-b7e3-f22120fb524b",
    "userId": "8478f478-80b1-7092-d595-8f5fa7d36f82",
    "title": "TC005-create project with valid team association",
    "description": "Test the /projects POST endpoint to create a new project linked to an existing team, verifying that the project is created successfully with correct metadata.",
    "code": "import requests\nimport uuid\nimport random\nimport string\n\nBASE_URL = \"http://localhost:8000/api/v1\"\nTIMEOUT = 30\n\ndef random_string(length=8):\n    return ''.join(random.choices(string.ascii_lowercase + string.digits, k=length))\n\ndef test_create_project_with_valid_team_association():\n    # Step 1: Register a new user (unique email)\n    email = f\"testuser_{random_string()}@example.com\"\n    password = \"TestPass123!\"\n    first_name = \"Test\"\n    last_name = \"User\"\n    register_payload = {\n        \"email\": email,\n        \"password\": password,\n        \"first_name\": first_name,\n        \"last_name\": last_name\n    }\n    register_resp = requests.post(f\"{BASE_URL}/auth/register\", json=register_payload, timeout=TIMEOUT)\n    assert register_resp.status_code == 201, f\"User registration failed: {register_resp.text}\"\n\n    # Step 2: Login to obtain access token\n    login_data = {\n        \"username\": email,\n        \"password\": password\n    }\n    login_resp = requests.post(f\"{BASE_URL}/auth/login\", data=login_data, headers={\"Content-Type\": \"application/x-www-form-urlencoded\"}, timeout=TIMEOUT)\n    assert login_resp.status_code == 200, f\"Login failed: {login_resp.text}\"\n    login_json = login_resp.json()\n    access_token = login_json.get(\"access_token\")\n    assert access_token, \"Access token not found in login response\"\n\n    headers = {\n        \"Authorization\": f\"Bearer {access_token}\",\n        \"Content-Type\": \"application/json\"\n    }\n\n    # Step 3: Create organization (which auto-creates default team)\n    org_name = f\"Test Organization {random_string(6)}\"\n    org_payload = {\"name\": org_name}\n    org_resp = requests.post(f\"{BASE_URL}/organizations\", json=org_payload, headers=headers, timeout=TIMEOUT)\n    assert org_resp.status_code == 201, f\"Organization creation failed: {org_resp.text}\"\n    org_json = org_resp.json()\n    org_id = org_json.get(\"id\")\n    assert org_id, \"Organization ID missing in response\"\n\n    # Step 4: Get existing teams to find the default team created with the org\n    teams_resp = requests.get(f\"{BASE_URL}/teams\", headers=headers, timeout=TIMEOUT)\n    assert teams_resp.status_code == 200, f\"Failed to fetch teams: {teams_resp.text}\"\n    teams = teams_resp.json()\n    # Find a team that belongs to this org; since auto-created team is for the org user\n    # Assuming teams contain \"organization_id\" or linked info; if not, just pick the first team\n    default_team = None\n    for team in teams:\n        # If organization linkage is available, filter by org_id\n        # Otherwise pick the first\n        if \"organization_id\" in team and team[\"organization_id\"] == org_id:\n            default_team = team\n            break\n    if not default_team and teams:\n        default_team = teams[0]\n    assert default_team is not None, \"No team found to associate with project\"\n    team_id = default_team.get(\"id\")\n    assert team_id, \"Team ID missing\"\n\n    # Step 5: Create Project linked to the team\n    project_name = f\"Project {random_string(6)}\"\n    project_payload = {\n        \"name\": project_name,\n        \"team_id\": team_id,\n        \"icon\": \"default_icon\",\n        \"color\": \"#000000\"\n    }\n\n    project_resp = None\n    project_id = None\n    try:\n        project_resp = requests.post(f\"{BASE_URL}/projects\", json=project_payload, headers=headers, timeout=TIMEOUT)\n        assert project_resp.status_code == 201, f\"Project creation failed: {project_resp.text}\"\n        project_json = project_resp.json()\n        project_id = project_json.get(\"id\")\n        assert project_id, \"Project ID missing in response\"\n        # Validate metadata matches request\n        assert project_json.get(\"name\") == project_name, \"Project name mismatch\"\n        assert project_json.get(\"team_id\") == team_id, \"Project team_id mismatch\"\n    finally:\n        # Cleanup: delete the created project if exists\n        if project_id:\n            requests.delete(f\"{BASE_URL}/projects/{project_id}\", headers=headers, timeout=TIMEOUT)\n        # Optionally cleanup: organization and user could be deleted as well if API supports\n\ntest_create_project_with_valid_team_association()\n",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-01-25T21:03:27.815Z",
    "modified": "2026-01-25T21:04:51.192Z"
  },
  {
    "projectId": "eb8cad19-0f4f-47b0-997f-d05e3bc5e388",
    "testId": "c8dc2016-0c76-4921-a009-3df74053b52f",
    "userId": "8478f478-80b1-7092-d595-8f5fa7d36f82",
    "title": "TC006-create feature with valid project linkage",
    "description": "Test the /features POST endpoint to create a new feature associated with a valid project, ensuring status lifecycle values are accepted and enforced.",
    "code": "import requests\nimport uuid\nimport time\n\nBASE_URL = \"http://localhost:8000/api/v1\"\nTIMEOUT = 30\n\ndef test_create_feature_with_valid_project_linkage():\n    unique_suffix = str(uuid.uuid4())\n    user_email = f\"user_{unique_suffix}@example.com\"\n    user_password = \"TestPass123!\"\n    first_name = \"TestFirstName\"\n    last_name = \"TestLastName\"\n    org_name = f\"Org_{unique_suffix}\"\n    team_name = f\"Team_{unique_suffix}\"\n    team_identifier = f\"identifier_{unique_suffix}\"\n    project_name = f\"Project_{unique_suffix}\"\n    feature_name = f\"Feature_{unique_suffix}\"\n    \n    headers = {\"Content-Type\": \"application/json\"}\n\n    # Step 1: Register user\n    register_payload = {\n        \"email\": user_email,\n        \"password\": user_password,\n        \"first_name\": first_name,\n        \"last_name\": last_name,\n    }\n    r = requests.post(f\"{BASE_URL}/auth/register\", json=register_payload, timeout=TIMEOUT)\n    assert r.status_code == 201 or r.status_code == 200, f\"Failed to register user: {r.text}\"\n\n    # Step 2: Login to get access token\n    login_data = {\n        \"username\": user_email,\n        \"password\": user_password\n    }\n    r = requests.post(f\"{BASE_URL}/auth/login\", data=login_data, timeout=TIMEOUT)\n    assert r.status_code == 200, f\"Failed to login: {r.text}\"\n    login_res = r.json()\n    assert \"access_token\" in login_res or \"token\" in login_res, f\"No token in login response: {login_res}\"\n    token = login_res.get(\"access_token\") or login_res.get(\"token\")\n    auth_headers = {\n        \"Authorization\": f\"Bearer {token}\",\n        \"Content-Type\": \"application/json\"\n    }\n\n    created_org_id = None\n    created_team_id = None\n    created_project_id = None\n    created_feature_id = None\n\n    try:\n        # Step 3: Create organization\n        org_payload = {\"name\": org_name}\n        r = requests.post(f\"{BASE_URL}/organizations\", json=org_payload, headers=auth_headers, timeout=TIMEOUT)\n        assert r.status_code == 201 or r.status_code == 200, f\"Failed to create organization: {r.text}\"\n        org = r.json()\n        created_org_id = org.get(\"id\")\n        assert created_org_id, f\"Organization ID not returned: {org}\"\n\n        # Because org creation automatically creates default team. But we will create a new team to attach project.\n        # Step 4: Create team with unique identifier\n        team_payload = {\n            \"name\": team_name,\n            \"identifier\": team_identifier\n        }\n        r = requests.post(f\"{BASE_URL}/teams\", json=team_payload, headers=auth_headers, timeout=TIMEOUT)\n        assert r.status_code == 201 or r.status_code == 200, f\"Failed to create team: {r.text}\"\n        team = r.json()\n        created_team_id = team.get(\"id\")\n        assert created_team_id, f\"Team ID not returned: {team}\"\n\n        # Step 5: Create project linked to the team\n        project_payload = {\n            \"name\": project_name,\n            \"team_id\": created_team_id\n        }\n        r = requests.post(f\"{BASE_URL}/projects\", json=project_payload, headers=auth_headers, timeout=TIMEOUT)\n        assert r.status_code == 201 or r.status_code == 200, f\"Failed to create project: {r.text}\"\n        project = r.json()\n        created_project_id = project.get(\"id\")\n        assert created_project_id, f\"Project ID not returned: {project}\"\n\n        # Step 6: Create feature linked to the project, test all valid statuses accepted and enforced.\n        # For brevity test one valid status, other statuses have same rules.\n        valid_statuses = [\n            \"discovery\",\n            \"validated\",\n            \"in_build\",\n            \"in_review\",\n            \"shipped\",\n            \"adopted\",\n            \"killed\"\n        ]\n        for status in valid_statuses:\n            feature_payload = {\n                \"name\": f\"{feature_name}_{status}\",\n                \"project_id\": created_project_id,\n                \"status\": status\n            }\n            r = requests.post(f\"{BASE_URL}/features\", json=feature_payload, headers=auth_headers, timeout=TIMEOUT)\n            assert r.status_code == 201 or r.status_code == 200, f\"Failed to create feature with status '{status}': {r.text}\"\n            feature = r.json()\n            fid = feature.get(\"id\")\n            assert fid, f\"Feature ID not returned for status '{status}': {feature}\"\n            # Clean up feature immediately to avoid accumulation\n            del_r = requests.delete(f\"{BASE_URL}/features/{fid}\", headers=auth_headers, timeout=TIMEOUT)\n            assert del_r.status_code == 200 or del_r.status_code == 204, f\"Failed to delete feature '{fid}' during cleanup: {del_r.text}\"\n\n        # Finally create one feature for the main test to ensure independent resource for possible further use\n        feature_payload = {\n            \"name\": feature_name,\n            \"project_id\": created_project_id,\n            \"status\": \"discovery\"\n        }\n        r = requests.post(f\"{BASE_URL}/features\", json=feature_payload, headers=auth_headers, timeout=TIMEOUT)\n        assert r.status_code == 201 or r.status_code == 200, f\"Failed to create feature: {r.text}\"\n        feature = r.json()\n        created_feature_id = feature.get(\"id\")\n        assert created_feature_id, f\"Feature ID not returned: {feature}\"\n\n    finally:\n        # Cleanup - delete feature, project, team, organization in reverse order\n        if created_feature_id:\n            requests.delete(f\"{BASE_URL}/features/{created_feature_id}\", headers=auth_headers, timeout=TIMEOUT)\n        if created_project_id:\n            requests.delete(f\"{BASE_URL}/projects/{created_project_id}\", headers=auth_headers, timeout=TIMEOUT)\n        if created_team_id:\n            requests.delete(f\"{BASE_URL}/teams/{created_team_id}\", headers=auth_headers, timeout=TIMEOUT)\n        if created_org_id:\n            requests.delete(f\"{BASE_URL}/organizations/{created_org_id}\", headers=auth_headers, timeout=TIMEOUT)\n\ntest_create_feature_with_valid_project_linkage()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 133, in <module>\n  File \"<string>\", line 68, in test_create_feature_with_valid_project_linkage\nAssertionError: Failed to create team: Internal Server Error\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-01-25T21:03:27.819Z",
    "modified": "2026-01-25T21:04:24.325Z"
  },
  {
    "projectId": "eb8cad19-0f4f-47b0-997f-d05e3bc5e388",
    "testId": "97455640-955b-4c34-8d93-7d08ef0604fd",
    "userId": "8478f478-80b1-7092-d595-8f5fa7d36f82",
    "title": "TC007-create issue with valid feature and status",
    "description": "Test the /issues POST endpoint to create a new issue linked to an existing feature, verifying that status and priority values are correctly handled.",
    "code": "import requests\nimport uuid\n\nBASE_URL = \"http://localhost:8000/api/v1\"\nTIMEOUT = 30\n\ndef test_create_issue_with_valid_feature_and_status():\n    unique_suffix = str(uuid.uuid4())\n    email = f\"testuser_{unique_suffix}@example.com\"\n    password = \"Password123!\"\n    first_name = f\"TestFirst{unique_suffix[:8]}\"\n    last_name = f\"TestLast{unique_suffix[9:13]}\"\n\n    headers = {\"Content-Type\": \"application/json\"}\n\n    # Register user\n    reg_payload = {\n        \"email\": email,\n        \"password\": password,\n        \"first_name\": first_name,\n        \"last_name\": last_name,\n    }\n    reg_resp = requests.post(f\"{BASE_URL}/auth/register\", json=reg_payload, timeout=TIMEOUT)\n    assert reg_resp.status_code == 201, f\"Registration failed: {reg_resp.text}\"\n\n    # Login to get JWT token\n    login_data = {\"username\": email, \"password\": password}\n    login_resp = requests.post(f\"{BASE_URL}/auth/login\", data=login_data, timeout=TIMEOUT)\n    assert login_resp.status_code == 200, f\"Login failed: {login_resp.text}\"\n    login_json = login_resp.json()\n    assert \"access_token\" in login_json, \"No access token in login response\"\n    token = login_json[\"access_token\"]\n    auth_headers = {\"Authorization\": f\"Bearer {token}\", \"Content-Type\": \"application/json\"}\n\n    # Create Organization\n    org_name = f\"Org_{unique_suffix[:8]}\"\n    org_payload = {\"name\": org_name}\n    org_resp = requests.post(f\"{BASE_URL}/organizations\", json=org_payload, headers=auth_headers, timeout=TIMEOUT)\n    assert org_resp.status_code == 201, f\"Organization creation failed: {org_resp.text}\"\n    org_id = org_resp.json().get(\"id\")\n    assert org_id, \"Organization ID missing in response\"\n\n    # Get Default Team from Organization creation (assuming endpoint /teams?organization_id=org_id)\n    teams_resp = requests.get(f\"{BASE_URL}/teams\", headers=auth_headers, timeout=TIMEOUT)\n    assert teams_resp.status_code == 200, f\"Failed to list teams: {teams_resp.text}\"\n    teams = teams_resp.json()\n    default_team = None\n    for team in teams:\n        if team.get(\"organization_id\") == org_id:\n            default_team = team\n            break\n    assert default_team is not None, \"Default team not found after organization creation\"\n    team_id = default_team[\"id\"]\n\n    # Create Project linked to the default Team with required icon and color\n    project_name = f\"Project_{unique_suffix[:8]}\"\n    project_payload = {\"name\": project_name, \"team_id\": team_id, \"icon\": \"ðŸš€\", \"color\": \"#FF5733\"}\n    project_resp = requests.post(f\"{BASE_URL}/projects\", json=project_payload, headers=auth_headers, timeout=TIMEOUT)\n    assert project_resp.status_code == 201, f\"Project creation failed: {project_resp.text}\"\n    project_id = project_resp.json().get(\"id\")\n    assert project_id, \"Project ID missing in response\"\n\n    # Create Feature linked to the Project with valid status\n    feature_name = f\"Feature_{unique_suffix[:8]}\"\n    feature_status = \"validated\"\n    feature_payload = {\"name\": feature_name, \"project_id\": project_id, \"status\": feature_status}\n    feature_resp = requests.post(f\"{BASE_URL}/features\", json=feature_payload, headers=auth_headers, timeout=TIMEOUT)\n    assert feature_resp.status_code == 201, f\"Feature creation failed: {feature_resp.text}\"\n    feature_data = feature_resp.json()\n    feature_id = feature_data.get(\"id\")\n    assert feature_id, \"Feature ID missing in response\"\n    assert feature_data.get(\"status\") == feature_status, \"Feature status mismatch\"\n\n    issue_id = None\n    try:\n        # Create Issue linked to the Feature with valid status and priority\n        issue_title = f\"Issue_{unique_suffix[:8]}\"\n        issue_status = \"todo\"\n        issue_priority = \"high\"\n        issue_payload = {\n            \"title\": issue_title,\n            \"feature_id\": feature_id,\n            \"status\": issue_status,\n            \"priority\": issue_priority\n        }\n        issue_resp = requests.post(f\"{BASE_URL}/issues\", json=issue_payload, headers=auth_headers, timeout=TIMEOUT)\n        assert issue_resp.status_code == 201, f\"Issue creation failed: {issue_resp.text}\"\n        issue_data = issue_resp.json()\n        issue_id = issue_data.get(\"id\")\n        assert issue_id, \"Issue ID missing in response\"\n        assert issue_data.get(\"status\") == issue_status, \"Issue status mismatch\"\n        assert issue_data.get(\"priority\") == issue_priority, \"Issue priority mismatch\"\n    finally:\n        if issue_id:\n            requests.delete(f\"{BASE_URL}/issues/{issue_id}\", headers=auth_headers, timeout=TIMEOUT)\n        if feature_id:\n            requests.delete(f\"{BASE_URL}/features/{feature_id}\", headers=auth_headers, timeout=TIMEOUT)\n        if project_id:\n            requests.delete(f\"{BASE_URL}/projects/{project_id}\", headers=auth_headers, timeout=TIMEOUT)\n        if org_id:\n            requests.delete(f\"{BASE_URL}/organizations/{org_id}\", headers=auth_headers, timeout=TIMEOUT)\n\ntest_create_issue_with_valid_feature_and_status()\n",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2026-01-25T21:03:27.825Z",
    "modified": "2026-01-25T21:05:03.188Z"
  }
]
